experiment_label: "experiment"
enable_training: true
enable_evaluation: false

# Settings about model
model:
  # For available choices, see "ModelBackbone" in src/schemas/constants.py
  backbone: resnet18
  num_classes: 2
  weights: DEFAULT
  unfreeze_all_params: false
  weights_path: null

# Settings about dataloader
dataloader:
  # For poetry enviorment, input relative path/absolute path to the trainset
  # For docker enviorment, input ${DATA_DIR}/< path to the trainset within that folder>
  trainset_dir: ./tests/test_dataset/
  valset_dir: ./tests/test_dataset/
  testset_dir: null
  batch_size: 1
  num_workers: 4

preprocessing:
  mean: [0.485, 0.456, 0.406]
  std: [0.229, 0.224, 0.225]

  resize_config:
    width: 48
    height: 48
    # For available choices, see "InterpolationType" in src/schemas/constants.py
    interpolation: inter_cubic
    # For available choices, see "PaddingType" in src/schemas/constants.py
    padding: bottom_right
    maintain_aspect_ratio: true

  spatial_config:
    # Probability in [0., 1.]
    hflip_prob: 0.5
    vflip_prob: 0.5
    max_rotate_in_degree: 10 # in degrees
    allow_center_crop: false
    allow_random_crop: false

  color_config:
    allow_gray_scale: false
    allow_random_color: false

training:
  name: "experiment"
  device: cuda
  precision: 64
  random_seed: 42
  num_epochs: 20
  max_num_hrs: null
  validate_every_n_epoch: 1
  save_every_n_epoch: 1
  patience_in_epoch: 10
  # available choice: loss, accuracy
  criterion: loss
  export_last_as_onnx: true
  export_best_as_onnx: true

  scheduler:
    # For available choices, see "SchedulerType" in src/schemas/constants.py
    name: step
    lr_min: 0
    step_size: 30 # Only for step
    gamma: 0.1 # Only for step

  optimizer:
    # For available choices, see "OptimizerType" in src/schemas/constants.py
    name: adam
    lr: 1e-7
    weight_decay: 0
    # Only used for sgd / rmsprop
    momentum: 0.9
    # Only used for rmsprop
    alpha: 0.99
    # Only used for adam / adamw
    betas: [0.9, 0.999]

evaluation:
  evalset_dir: ../dataset/val
  mapping_path: class_mapping.yml
  models:
    - name: default
      weights_path: ./best_model.pt
      backbone: resnet18
